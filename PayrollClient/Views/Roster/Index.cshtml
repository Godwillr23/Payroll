@model IEnumerable<PayrolSystem.Models.DatabaseFirst.ScheduleTable>

@{
    ViewBag.Title = "Rates";
}

<style type="text/css">
    .col-md-10 {
        color: #fff;
    }

    #radio label {
        float: right;
        display: inline;
    }

    label {
        margin-top: 7px !important;
    }

    radio {
        display: inline;
    }

    p {
        margin: 0px 10px 10px;
    }

    input[type="radio"], input[type="checkbox"] {
        margin: 0;
        margin-left: 20px;
        line-height: normal;
        margin-bottom: 10px;
    }

    .styled-table {
        border-collapse: collapse;
        margin: 25px 0;
        font-size: 0.9em;
        font-family: sans-serif;
        min-width: 400px;
        box-shadow: 0 0 20px green;
    }
</style>
@functions {

            PayrolSystem.Models.DatabaseFirst.PayrolSystemDBEntities _context = new PayrolSystem.Models.DatabaseFirst.PayrolSystemDBEntities();

            public string GetSiteName(int id)
            {
                string sitename = (from e in _context.SiteTables where e.SiteID == id select e.SiteName).FirstOrDefault();

                return sitename;
            }

            public string GetPersNo(int guardId)
            {
                string PersNo = (from e in _context.GuardsDetails where e.GuardsID == guardId select e.PersNo).FirstOrDefault();

                return PersNo;
            }

            public string GetNames(int guardId)
            {
                string PersNo = (from e in _context.GuardsDetails where e.GuardsID == guardId select e.FirstName + " " + e.LastName).FirstOrDefault();

                return PersNo;
            }

            public string GetGrade(int guardId)
            {
                string PersNo = (from e in _context.GuardsDetails where e.GuardsID == guardId select e.Grade).FirstOrDefault();

                return PersNo;
            }

            public string GetContactNo(int guardId)
            {
                string PersNo = (from e in _context.GuardsDetails where e.GuardsID == guardId select e.CellNo).FirstOrDefault();

                return PersNo;
            }

            public string GetWorkDay(int guardId, string day)
            {
                string ShiftDay = (from e in _context.ScheduleTables where e.GuardID == guardId select e.ScheduledDay).FirstOrDefault();
                var ShiftID = (from e in _context.ScheduleTables where e.GuardID == guardId && e.ScheduledDay == day select e.ShiftID).FirstOrDefault();

                string Shift = "";

                if (ShiftID == 1)
                {
                    Shift = "D";
                }
                else if (ShiftID == 2)
                {
                    Shift = "N";
                }
                else if (ShiftID == 3)
                {
                    Shift = "O";
                }

                return Shift;
            }

        }

<div class="jumbotron">
    <h2 style="margin-top: 0;">Weekly Roster</h2>
    @using (Html.BeginForm("Search", "Rate", FormMethod.Get))
    {
        <div style="display: inline-flex;">
            <input type="text" name="q" required class="form-control" style="width:250px" />
            <input type="submit" value="Search" class="btn btn-warning" id="btnSubmit" style="width:150px;margin-left: 10px;" />
        </div>
        <br />
    }
    @if (Model.Count() > 0)
    {
        <div style="overflow:auto;">
            <table class="table table-hover table-condensed" style="width:100%;margin: 10px;color:midnightblue">
                <thead style="background-color:midnightblue; color:#fff;">
                    <tr>
                        <td><b>Site Name</b></td>
                        <td><b>Pers No</b></td>
                        <td><b>Names</b></td>
                        <td><b>Grade</b></td>
                        <td><b>Contact No.</b></td>
                        <td><b>Monday</b></td>
                        <td><b>Tuesday</b></td>
                        <td><b>Wednesday</b></td>
                        <td><b>Thursday</b></td>
                        <td><b>Friday</b></td>
                        <td><b>Saturday</b></td>
                        <td><b>Sunday</b></td>
                    </tr>
                </thead>
                @foreach (var prod in Model)
                {
                <tr>
                    <td><b>@GetSiteName(prod.SiteID)</b></td>
                    <td><b>@GetPersNo(prod.GuardID)</b></td>
                    <td><b>@GetNames(prod.GuardID)</b></td>
                    <td><b>@GetGrade(prod.GuardID)</b></td>
                    <td><b>@GetContactNo(prod.GuardID)</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Mon")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Tue")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Wed")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Thu")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Fri")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Sat")</b></td>
                    <td><b>@GetWorkDay(prod.GuardID, "Sun")</b></td>
                </tr>
                }

            </table>
        </div>

    }
    @if (Model.Count() < 1)
    {
        <div class="alert alert-danger">
            <p style="text-align:center; color:red; font-size:14px;">No Guard found</p>
        </div>
    }
    <br />
    <span class="alert alert-info">Total Guards: @Model.Count()</span>
    <br />

    <button style="float:right" class="btn btn-primary" type="button" onclick="redirect()">Add Schedule</button>
</div>

<script>
    function redirect() {
        window.location.pathname = "Schedule/CreateSchedule";
    }
</script>

